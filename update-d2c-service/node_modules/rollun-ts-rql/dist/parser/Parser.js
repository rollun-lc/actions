"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _SortNodeParser=_interopRequireDefault(require("./nodeParsers/SortNodeParser"));var _AndNodeParser=_interopRequireDefault(require("./nodeParsers/query/logicalOperators/AndNodeParser"));var _QueryNodeParser=_interopRequireDefault(require("./nodeParsers/QueryNodeParser"));var _SelectNodeParser=_interopRequireDefault(require("./nodeParsers/SelectNodeParser"));var _NotNodeParser=_interopRequireDefault(require("./nodeParsers/query/logicalOperators/NotNodeParser"));var _OrNodeParser=_interopRequireDefault(require("./nodeParsers/query/logicalOperators/OrNodeParser"));var _LimitNodeParser=_interopRequireDefault(require("./nodeParsers/LimitNodeParser"));var _Token=require("./Token");var _IntegerParser=_interopRequireDefault(require("./valueParsers/IntegerParser"));var _FieldParser=_interopRequireDefault(require("./valueParsers/FieldParser"));var _StringTypeCaster=_interopRequireDefault(require("./typeCasters/StringTypeCaster"));var _IntegerTypeCaster=require("./typeCasters/IntegerTypeCaster");var _FloatTypeCaster=_interopRequireDefault(require("./typeCasters/FloatTypeCaster"));var _ArrayParser=_interopRequireDefault(require("./valueParsers/ArrayParser"));var _NodeParserChain=_interopRequireDefault(require("./NodeParserChain"));var _BooleanTypeCaster=_interopRequireDefault(require("./typeCasters/BooleanTypeCaster"));var _ScalarParser=_interopRequireDefault(require("./valueParsers/ScalarParser"));var _InNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/rql/InNodeParser"));var _OutNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/rql/OutNodeParser"));var _NeNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/rql/NeNodeParser"));var _LtNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/rql/LtNodeParser"));var _GtNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/rql/GtNodeParser"));var _EqNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/rql/EqNodeParser"));var _LeNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/rql/LeNodeParser"));var _GeNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/rql/GeNodeParser"));var _LikeNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/rql/LikeNodeParser"));var _FiqlInNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/fiql/FiqlInNodeParser"));var _FiqlOutNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/fiql/FiqlOutNodeParser"));var _FiqlEqNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/fiql/FiqlEqNodeParser"));var _FiqlNeNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/fiql/FiqlNeNodeParser"));var _FiqlLtNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/fiql/FiqlLtNodeParser"));var _FiqlGtNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/fiql/FiqlGtNodeParser"));var _FiqlLeNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/fiql/FiqlLeNodeParser"));var _FiqlLikeNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/fiql/FiqlLikeNodeParser"));var _FiqlGeNodeParser=_interopRequireDefault(require("./nodeParsers/query/comparisonOperators/fiql/FiqlGeNodeParser"));var _QueryBuilder=_interopRequireDefault(require("../QueryBuilder"));var _GlobParser=_interopRequireDefault(require("./valueParsers/GlobParser "));var _GroupbyNodeParser=_interopRequireDefault(require("./nodeParsers/GroupbyNodeParser"));var _GroupNodeParser=_interopRequireDefault(require("./nodeParsers/query/GroupNodeParser"));var _EqnNodeParser=_interopRequireDefault(require("./nodeParsers/query/binaryOperator/rql/EqnNodeParser"));var _EqfNodeParser=_interopRequireDefault(require("./nodeParsers/query/binaryOperator/rql/EqfNodeParser"));var _EqtNodeParser=_interopRequireDefault(require("./nodeParsers/query/binaryOperator/rql/EqtNodeParser "));var _IeNodeParser=_interopRequireDefault(require("./nodeParsers/query/binaryOperator/rql/IeNodeParser"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var Parser=function(){function Parser(){var nodeParser=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;_classCallCheck(this,Parser);_defineProperty(this,"nodeParser",void 0);this.nodeParser=nodeParser?nodeParser:Parser.createDefaultNodeParser()}_createClass(Parser,[{key:"setNodeParser",value:function setNodeParser(nodeParser){this.nodeParser=nodeParser;return this}},{key:"getNodeParser",value:function getNodeParser(){return this.nodeParser}},{key:"parse",value:function parse(tokenStream){var queryBuilder=this.createQueryBuilder();while(!tokenStream.isEnd()){queryBuilder.addNode(this.nodeParser.parse(tokenStream));tokenStream.nextIf(_Token.TokenTypeNameMap.T_AMPERSAND)}return queryBuilder.getQuery()}},{key:"createQueryBuilder",value:function createQueryBuilder(){return new _QueryBuilder["default"]}}],[{key:"createDefaultNodeParser",value:function createDefaultNodeParser(){var scalarParser=new _ScalarParser["default"]().registerTypeCaster("string",new _StringTypeCaster["default"]).registerTypeCaster("integer",new _IntegerTypeCaster.IntegerTypeCaster).registerTypeCaster("float",new _FloatTypeCaster["default"]).registerTypeCaster("boolean",new _BooleanTypeCaster["default"]);var arrayParser=new _ArrayParser["default"](scalarParser);var globParser=new _GlobParser["default"];var fieldParser=new _FieldParser["default"];var integerParser=new _IntegerParser["default"];var queryNodeParser=new _QueryNodeParser["default"];queryNodeParser.addNodeParser(new _GroupNodeParser["default"](queryNodeParser)).addNodeParser(new _AndNodeParser["default"](queryNodeParser)).addNodeParser(new _OrNodeParser["default"](queryNodeParser)).addNodeParser(new _NotNodeParser["default"](queryNodeParser)).addNodeParser(new _InNodeParser["default"](fieldParser,arrayParser)).addNodeParser(new _OutNodeParser["default"](fieldParser,arrayParser)).addNodeParser(new _EqNodeParser["default"](fieldParser,scalarParser)).addNodeParser(new _NeNodeParser["default"](fieldParser,scalarParser)).addNodeParser(new _LtNodeParser["default"](fieldParser,scalarParser)).addNodeParser(new _GtNodeParser["default"](fieldParser,scalarParser)).addNodeParser(new _LeNodeParser["default"](fieldParser,scalarParser)).addNodeParser(new _GeNodeParser["default"](fieldParser,scalarParser)).addNodeParser(new _EqnNodeParser["default"]).addNodeParser(new _EqfNodeParser["default"]).addNodeParser(new _EqtNodeParser["default"]).addNodeParser(new _IeNodeParser["default"]).addNodeParser(new _LikeNodeParser["default"](fieldParser,globParser)).addNodeParser(new _FiqlInNodeParser["default"](fieldParser,arrayParser)).addNodeParser(new _FiqlOutNodeParser["default"](fieldParser,arrayParser)).addNodeParser(new _FiqlEqNodeParser["default"](fieldParser,scalarParser)).addNodeParser(new _FiqlNeNodeParser["default"](fieldParser,scalarParser)).addNodeParser(new _FiqlLtNodeParser["default"](fieldParser,scalarParser)).addNodeParser(new _FiqlGtNodeParser["default"](fieldParser,scalarParser)).addNodeParser(new _FiqlLeNodeParser["default"](fieldParser,scalarParser)).addNodeParser(new _FiqlGeNodeParser["default"](fieldParser,scalarParser)).addNodeParser(new _FiqlLikeNodeParser["default"](fieldParser,globParser));return new _NodeParserChain["default"]().addNodeParser(queryNodeParser).addNodeParser(new _SelectNodeParser["default"](fieldParser)).addNodeParser(new _SortNodeParser["default"](fieldParser)).addNodeParser(new _LimitNodeParser["default"](integerParser)).addNodeParser(new _GroupbyNodeParser["default"])}}]);return Parser}();exports["default"]=Parser;